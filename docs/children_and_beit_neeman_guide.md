# מאגר ילדים ובית נאמן - מדריך שימוש

## סקירה כללית
התכונות החדשות מוסיפות שני מאגרי מידע חשובים למערכת:

1. **מאגר ילדים** - ניהול מלא של פרטי ילדים משויכים להורים
2. **בית נאמן** - רשימה מיוחדת של ילדים והוריהם מעל גיל 16

---

## מאגר ילדים

### תכונות עיקריות:
- שיוך ילדים להורים לפי תעודת זהות של האב
- מעקב אחר פרטים מלאים: שם, מין, תאריך לידה עברי ולועזי, תעודת זהות
- חישוב גיל אוטומטי לפי תאריך עברי
- סטטוסים: רווק, מאורס, נשוי, גרוש
- **ילדים נשואים אוטומטית מועברים לרשימת "ילדים נשואים" ולא מופיעים במאגר הילדים הרגיל**

### איך להוסיף ילד חדש:
1. היכנס ללשונית "מאגר ילדים"
2. לחץ על כפתור "הוסף ילד חדש"
3. בחר הורה מהרשימה (לפי שם ומשפחה)
4. מלא את פרטי הילד:
   - שם הילד (חובה)
   - מין (חובה)
   - תאריך לידה עברי (יום, חודש, שנה)
   - תאריך לידה לועזי
   - תעודת זהות
   - סטטוס
   - הערות
5. לחץ "שמור"

### עריכה ומחיקה:
- לחץ על כפתור העריכה (עיפרון) ליד הילד שברצונך לערוך
- לחץ על כפתור המחיקה (פח אשפה) למחיקת ילד (דורש אישור)

### ייבוא מאקסל:
1. לחץ "ייבא אקסל"
2. בחר קובץ Excel עם העמודות הבאות:
   - שם משפחה
   - שם הילד
   - מין
   - יום, חודש, שנה
   - ת. לידה לועזי
   - תעודת זהות
   - הערות
   - סטטוס
   - ת.ז. הורה
3. המערכת תעדכן אוטומטית רשומות קיימות או תוסיף חדשות

### ייצוא לאקסל:
- לחץ "ייצוא אקסל" להורדת כל פרטי הילדים (ללא נשואים)

---

## בית נאמן

### תכונות עיקריות:
- רשימה ממוקדת של ילדים מעל גיל 16 עם פרטי הורים מלאים
- עמודות נוסxxxxxxxום לימודים, טלפוני הורים, כתובת מלאה
- **סנכרון אוטומטי** ממאגר הילדים
- עדכון סטטוס מתעדכן גם במאגר הילדים

### איך להוסיף רשומה:
1. היכנס ללשונית "בית נאמן"
2. לחץ "הוסף חדש"
3. מלא את כל הפרטים:
   - שם משפחה, שם הילד (חובה)
   - גיל, מין
   - פרטי אב: שם, נייד
   - פרטי אם: שם, לבית, נייד
   - כתובת ועיר
   - תאריך לידה עברי
   - מקום לימודים
   - הערות וסטטוס
4. לחץ "שמור"

### סנכרון אוטומטי:
- לחץ "סנכרון ממאגר ילדים" כדי לעדכן אוטומטית את כל הילדים מעל גיל 16 ממאגר הילדים
- המערכת תוסיף רשומות חדשות ותעדכן קיימות

### ייבוא וייצוא:
- **ייבוא**: קובץ Excel עם כל העמודות המפורטות לעיל
- **ייצוא**: הורדת כל הרשומות לקובץ Excel

---

## הצגת ילדים במודאל פרטי אדם

כאשר פותחים את פרטי אדם מהטבלה "פרטים מלאים":
1. מתחת לפרטים הכלליים תופיע קטגוריה חדשה: **"פרטי ילדים"**
2. הקטגוריה מציגה:
   - **סיכום**: כמה בנים, כמה בנות, כמה נשואים, סה"כ
   - **רשימת ילדים**: עם שם, גיל, מין, תאריך לידה, הערות וסטטוס
3. הנתונים נטענים אוטומטית לפי תעודת הזהות של האב

---

## קבצים שנוצרו/עודכנו

### קבצי Database:
- `sql/create_children_table.sql` - טבלת מאגר ילדים
- `sql/create_beit_neeman_table.sql` - טבלת בית נאמן
- `sql/run_create_tables.php` - סקריפט להרצת יצירת הטבלאות

### קבצי API:
- `pages/children_api.php` - API לניהול מאגר ילדים
- `pages/beit_neeman_api.php` - API לניהול בית נאמן

### קבצי JavaScript:
- `assets/js/children.js` - לוגיקת ממשק מאגר ילדים
- `assets/js/beit_neeman.js` - לוגיקת ממשק בית נאמן

### קבצי CSS:
- `assets/css/children.css` - עיצוב ממשק הילדים

### קבצים מעודכנים:
- `pages/people.php` - הוסף לשוניות ומודאלים חדשים
- `templates/person_details_modal.php` - הוסף סעיף פרטי ילדים
- `assets/js/people.js` - הוסף פונקציונליות טעינת ילדים

---

## הרשאות

- **צופים (viewers)**: יכולים לצפות בנתונים בלבד
- **עורכים**: יכולים להוסיף, לערוך ולמחוק רשומות
- ייבוא וייצוא זמינים לכל המשתמשים המורשים

---

## תמיכה טכנית

במקרה של בעיות:
1. בדוק שהטבלאות נוצרו בבסיס הנתונים (children, beit_neeman)
2. ודא שסקריפט `sql/run_create_tables.php` רץ בהצלחה
3. בדוק שיש הרשאות קריאה וכתיבה לקבצים החדשים

---

**תאריך עדכון**: פברואר 2026
**גרסה**: 1.0
