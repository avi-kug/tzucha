# מערכת תמיכות - הוראות הפעלה

## התקנה ראשונית

### 1. יצירת טבלת התמיכות במסד הנתונים

הרץ את הסקריפט SQL הבא:

```bash
mysql -u [username] -p [database_name] < sql/create_supports_table.sql
```

או העתק את התוכן של הקובץ `sql/create_supports_table.sql` והרץ אותו ב-phpMyAdmin.

### 2. הגדרת הרשאות

ודא שהמשתמש המחובר יש לו הרשאת 'supports' במערכת.

## שימוש במערכת

### טאב תמיכה (סיכומים)

טאב זה מציג את כל רשומות התמיכה עם חישובים אוטומטיים:

#### עמודות:
- **שם / משפחה / מס' תורם** - פרטי המקבל
- **כתובת / עיר** - מיקום
- **סה"כ הכנסות** - סיכום כל ההכנסות (משכורת/מלגה, קצבאות, וכו')
- **סה"כ הוצאות** - סיכום כל ההוצאות (דיור, שכר לימוד, הוצאה חריגה)
- **סה"כ הכנסות לנפש** - (סה"כ הכנסות - הוצאות) / מספר נפשות
- **סה"כ לתמיכה** - מחושב לפי הנוסחה:
  - אם הכנסה לנפש < 700 ₪ → **200 ₪ × מס' נפשות**
  - אם 700 ≤ הכנסה לנפש < 800 ₪ → **משלים עד 900 ₪ × מס' נפשות**
  - אם הכנסה לנפש ≥ 800 ₪ → **100 ₪ × מס' נפשות**

#### אפשרות חשובה:
☑️ **כלול הוצאה חריגה קבועה בחישוב סה"כ הוצאות** - סמן/בטל כדי לכלול או להוציא הוצאה חריגה מהחישוב.

### טאב נתונים

טאב זה מציג את כל השדות הגולמיים של כל רשומה. שימושי לבדיקה ועריכה מפורטת.

## פעולות זמינות

### ➕ הוספת תמיכה

1. לחץ על כפתור **"הוסף תמיכה"**
2. אפשרויות:
   - **בחירה מרשימת אנשים** - בחר אדם מהרשימה הקיימת ולחץ "טען נתונים" למילוי אוטומטי
   - **הזנה ידנית** - מלא את כל השדות ידנית
3. מלא את כל הפרטים:
   - **פרטים אישיים**: שם, כתובת, טלפון, וכו'
   - **הכנסות**: כל מקורות ההכנסה (עבודה, קצבאות, וכו')
   - **הוצאות**: דיור, שכר לימוד, הוצאות חריגות
   - **פרטי בנק**: לצורך העברת הכסף
4. לחץ **"שמור"**

### ✏️ עריכת תמיכה

לחץ על כפתור העריכה (✏️) בשורה המבוקשת, ערוך את הפרטים ושמור.

### 🗑️ מחיקת תמיכה

לחץ על כפתור המחיקה (🗑️) בשורה המבוקשת ואשר את המחיקה.

## ייבוא וייצוא Excel

### 📥 ייבוא מקובץ Excel

1. לחץ על **"ייבוא מאקסל"**
2. בחר קובץ Excel (.xlsx או .xls)
3. המערכת תבצע:
   - **זיהוי אוטומטי** - משווה לפי מספר זהות לאנשים הקיימים
   - **עדכון חכם** - מעדכן רק אם יש שינויים בנתונים
   - **שיוך ידני** - אם לא מצליח לזהות, תתבקש לשייך ידנית
4. תקבל דו"ח על:
   - כמה רשומות נוספו
   - כמה עודכנו
   - האם יש רשומות שצריך לשייך ידנית

### 📤 ייצוא לקובץ Excel

לחץ על **"ייצוא לאקסל"** - הקובץ יירד אוטומטית עם כל הנתונים.

## מבנה קובץ Excel לייבוא

הקובץ צריך לכלול את העמודות הבאות (בסדר):

| עמודה | שם השדה | הערות |
|-------|---------|-------|
| A | מזהה | להשאיר ריק לרשומות חדשות |
| B | תאריך יצירה | אוטומטי |
| C | תאריך עדכון | אוטומטי |
| D | שם עמדה | |
| E | שם פרטי | חובה |
| F | שם משפחה | חובה |
| G | מספר זהות | לזיהוי והתאמה |
| H | עיר | |
| I | רחוב | |
| J | מס' טל' | |
| K | מס' נפשות בבית | כולל ההורים |
| L | מס' ילדים נשואים | |
| M | מקום לימודים/עבודה 1 | |
| N | סכום הכנסה/מלגה 1 | |
| O | מקום לימודים/עבודה 2 | |
| P | סכום הכנסה/מלגה 2 | |
| Q | קצבת ילדים | |
| R | קצבת שארים | |
| S | קצבת נכות | |
| T | הבטחת הכנסה | |
| U | השלמת הכנסה | |
| V | סיוע בשכר דירה | |
| W | מקור הקצבה אחר | |
| X | סכום | |
| Y | הוצאות דיור | |
| Z | הוצאות שכר לימוד | |
| AA | הוצאה חריגה קבועה | |
| AB | פירוט - הוצאה חריגה | |
| AC | פרט מה סיבת הקושי | |
| AD | הערות | |
| AE | שם בעל החשבון | |
| AF | בנק | |
| AG | סניף | |
| AH | מס' חשבון | |
| AI | שם מבקש התמיכה | |
| AJ | מספר עסקה | |

## טיפים ושאלות נפוצות

### איך מזהים רשומות?

המערכת משתמשת במספר זהות לזיהוי והתאמה בין קובץ Excel לרשומות קיימות ולאנשים ברשימה.

### מה קורה אם הקובץ מכיל רשומה קיימת?

המערכת בודקת אם השדות השתנו. אם כן - מעדכנת. אם לא - משאירה כמו שהיא.

### איך משייכים ידנית?

אם המערכת לא מצליחה למצוא התאמה אוטומטית, תופיע חלונית שבה תוכל לבחור את האדם המתאים מהרשימה.

### איך לכלול/לא לכלול הוצאה חריגה?

בטאב "תמיכה", סמן או בטל את הסימון של התיבה "כלול הוצאה חריגה קבועה בחישוב סה"כ הוצאות".

### האם אפשר למחוק מספר רשומות בבת אחת?

כרגע צריך למחוק רשומה אחת בכל פעם. ניתן להוסיף פיצ'ר של מחיקה מרובה בעתיד.

## תמיכה טכנית

לבעיות או שאלות, פנה למפתח המערכת.

---

**גרסה:** 1.0  
**תאריך עדכון אחרון:** פברואר 2026
