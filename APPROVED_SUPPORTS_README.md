# תיעוד: מערכת אישור תמיכות

## מה נוסף?

### 1. טאב חדש - "תמיכות שאושרו"
- טאב שלישי בממשק שמציג את כל התמיכות שאושרו
- טבלה עם עמודות: מס' תורם, שם, משפחה, סכום, חודש תמיכה, תאריך אישור, פעולות
- סיכום סה"כ סכומים בתחתית הטבלה

### 2. שדות חדשים במודאל הוספת/עריכת תמיכה
- **סכום תמיכה**: שדה מספרי להזנת סכום התמיכה
- **חודש תמיכה**: בורר חודש/שנה (פורמט: YYYY-MM)

### 3. כפתור "אישור תמיכה" בטבלת התמיכה
- כפתור ירוק עם סמל V ליד כל שורה בטאב "תמיכה"
- לוחץ על הכפתור לאחר הזנת סכום וחודש במודל
- התמיכה תועבר לטאב "תמיכות שאושרו"

### 4. טבלאות חדשות במסד הנתונים
- **approved_supports**: טבלה לשמירת תמיכות מאושרות
- שדות נוספים בטבלת **supports**: support_amount, support_month

## איך להשתמש?

### התקנה ראשונית:
1. פתח phpMyAdmin
2. בחר את מסד הנתונים `tzucha`
3. לחץ על טאב "SQL"
4. העתק והדבק את התוכן של הקובץ: `sql/setup_approved_supports.sql`
5. לחץ "Go" להרצת הסקריפט

### תהליך אישור תמיכה:
1. פתח את עמוד התמיכות
2. הוסף או ערוך רשומת תמיכה
3. במודאל, הזן:
   - את כל פרטי התמיכה הרגילים
   - **סכום תמיכה** - הסכום שיאושר
   - **חודש תמיכה** - החודש עבורו ניתנת התמיכה
4. שמור את הרשומה
5. בטבלת התמיכה, לחץ על הכפתור הירוק "אשר" ליד התמיכה
6. אשר את הפעולה בחלון הקופץ
7. התמיכה תועבר לטאב "תמיכות שאושרו"

### צפייה בתמיכות מאושרות:
1. לחץ על הטאב "תמיכות שאושרו"
2. תראה רשימת תמיכות מאושרות ממוינות לפי חודש ותאריך
3. ניתן למחוק תמיכה מאושרת בלחיצה על כפתור המחיקה

## קבצים ששונו/נוספו:

### קבצי HTML/PHP:
- `pages/supports.php` - הוספת טאב חדש ושדות במודאל

### קבצי JavaScript:
- `assets/js/supports.js` - פונקציות לאישור תמיכות וטעינת נתונים

### קבצי CSS:
- `assets/css/supports.css` - עיצוב כפתור אישור

### קבצי API:
- `pages/supports_api.php` - endpoints חדשים:
  - `approve_support` - אישור תמיכה
  - `get_approved_supports` - קבלת תמיכות מאושרות
  - `delete_approved_support` - מחיקת תמיכה מאושרת

### קבצי SQL:
- `sql/setup_approved_supports.sql` - סקריפט התקנה מלא
- `sql/create_approved_supports_table.sql` - יצירת טבלת תמיכות מאושרות
- `sql/alter_supports_add_support_fields.sql` - הוספת שדות לטבלת תמיכות

## תכונות נוספות:

- **אבטחה**: רק משתמשים מורשים יכולים לאשר תמיכות (לא viewers)
- **מעקב**: התמיכות שומרות מידע על מי אישר ומתי
- **גמישות**: ניתן להזין סכומים שונים לכל חודש
- **ממשק ידידותי**: תצוגה בעברית עם פורמט ברור של סכומים ותאריכים

## הערות חשובות:

1. לפני אישור תמיכה, וודא שהזנת סכום וחודש תמיכה במודל
2. כל חודש = תמיכה בשורה נפרדת (ניתן לאשר מספר פעמים לאותה תמיכה אבל לחודשים שונים)
3. מחיקת רשומת תמיכה ימחק גם את כל האישורים הקשורים אליה (CASCADE)
